import pandas as pd

# Load the theoretical spectrum from the CSV file
theoretical_spectrum_df = pd.read_csv('total_scattered_spectrum.csv')

# Check the first few rows of the data
print(theoretical_spectrum_df.head())

# Check for missing (NaN) values in the theoretical spectrum
missing_values = theoretical_spectrum_df.isnull().sum()
print("Missing values in each column:", missing_values)

# Interpolate missing values in the "Total Scattered Spectrum" column
theoretical_spectrum_interpolated = theoretical_spectrum_df.copy()
theoretical_spectrum_interpolated['Total Scattered Spectrum'] = theoretical_spectrum_interpolated['Total Scattered Spectrum'].interpolate()


theoretical_spectrum_interpolated.to_csv('theoretical_spectrum_interpolated.csv')import pandas as pd

# File paths
input_file = '/Users/apple/Desktop/inter iit astro/theoretical_spectrum_interpolated.csv'  # Input CSV file
output_file = '/Users/apple/Desktop/inter iit astro/combined_data.csv'  # Output CSV file

# Load the CSV file
df = pd.read_csv(input_file)

# Identify duplicate rows based on the 'Energy' column
duplicates = df[df.duplicated(subset=['Energy'], keep=False)]

# Process duplicates by averaging their values
if not duplicates.empty:
    print("Processing duplicate rows...")
    averaged_duplicates = duplicates.groupby('Energy', as_index=False).mean()
    print("Averaged duplicates:")
    print(averaged_duplicates)
else:
    print("No duplicate rows found.")
    averaged_duplicates = pd.DataFrame(columns=df.columns)  # Empty DataFrame if no duplicates

# Get unique rows (excluding duplicates)
unique_rows = df.drop_duplicates(subset=['Energy'], keep=False)

# Combine unique rows with averaged duplicates
combined_df = pd.concat([unique_rows, averaged_duplicates], ignore_index=True)

# Sort by 'Energy' column to maintain order
combined_df = combined_df.sort_values(by='Energy').reset_index(drop=True)

# Save the combined data to a new CSV file
combined_df.to_csv(output_file, index=False)

print(f"Combined data saved to {output_file}")
